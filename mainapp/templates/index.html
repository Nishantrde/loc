<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Mobile: get GPS coords</title>
</head>
<body>
  <h3>Tap button to get your location (mobile)</h3>
  <button id="btn">Get location</button>
  <div id="info"></div>

  <script>
    const btn = document.getElementById('btn');
    const info = document.getElementById('info');

    async function getCoordsAndAddress() {
      if (!navigator.geolocation) {
        info.textContent = 'Geolocation not supported';
        return;
      }
      info.textContent = 'Requesting permission...';

      navigator.geolocation.getCurrentPosition(async pos => {
        const { latitude, longitude, accuracy } = pos.coords;
        info.innerHTML = `
          <b>Coords:</b> ${latitude.toFixed(6)}, ${longitude.toFixed(6)}<br/>
          <b>Accuracy:</b> Â±${Math.round(accuracy)} m<br/>
          Reverse geocoding...
        `;

        // Reverse geocode with OpenStreetMap Nominatim (light use only)
        const url = `https://nominatim.openstreetmap.org/reverse?format=jsonv2&lat=${latitude}&lon=${longitude}`;
        try {
          const res = await fetch(url, { headers: { Accept: 'application/json' }});
          const j = await res.json();
          info.innerHTML += `<br/><b>Address:</b> ${j.display_name || 'Not found'}`;
        } catch (e) {
          info.innerHTML += `<br/>Reverse geocode failed: ${e.message}`;
        }
      }, err => {
        info.textContent = 'Error: ' + (err.message || err.code);
      }, {
        enableHighAccuracy: true,
        timeout: 15000,
        maximumAge: 0
      });
    }

    btn.addEventListener('click', getCoordsAndAddress);
  </script>
</body>
</html>
